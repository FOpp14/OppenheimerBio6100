<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Franny Oppenheimer" />

<meta name="date" content="2024-02-28" />

<title>Homwork_07</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Homwork_07</h1>
<h4 class="author">Franny Oppenheimer</h4>
<h4 class="date">2024-02-28</h4>

</div>


<p><br/></p>
<div id="section" class="section level5">
<h5></h5>
<pre class="r"><code>library(ggplot2) # for graphics
library(MASS) # for maximum likelihood estimation
library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     select</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code># fit normal distribution to data + grab maximum likelihood estimators

z &lt;- read.csv(&quot;Allen et al - Proceedings B Supplementary Data - Raw Data 3.csv&quot;,header=TRUE,sep=&quot;,&quot;)
z$myVar &lt;-z$Mean.Unique.Units.per.Cycle
summary(z)</code></pre>
<pre><code>##       Year      Mean.Unique.Units.per.Cycle Mean.Total.Units.per.Cycle
##  Min.   :2002   Min.   :11.08               Min.   :101.1             
##  1st Qu.:2005   1st Qu.:16.25               1st Qu.:152.5             
##  Median :2008   Median :18.78               Median :170.8             
##  Mean   :2008   Mean   :20.04               Mean   :172.2             
##  3rd Qu.:2011   3rd Qu.:23.50               3rd Qu.:204.1             
##  Max.   :2014   Max.   :29.75               Max.   :228.0             
##                                                                       
##  Mean.Song.Cycle.Length..m.  Mean.Themes    Mean.Phrase.Length
##  Min.   : 4.253             Min.   :2.780   Min.   :12.96     
##  1st Qu.: 6.328             1st Qu.:3.750   1st Qu.:14.60     
##  Median : 7.450             Median :4.310   Median :15.93     
##  Mean   : 7.196             Mean   :4.505   Mean   :16.25     
##  3rd Qu.: 7.713             3rd Qu.:4.920   3rd Qu.:16.31     
##  Max.   :11.060             Max.   :6.860   Max.   :22.67     
##                                                               
##  mean.PCA.of.Themes  Total.Score      Song.Level.Score  Theme.Level.Score
##  Min.   :-1.15876   Min.   :-3.2997   Min.   :-2.5206   Min.   :-2.4552  
##  1st Qu.:-0.50409   1st Qu.:-1.4860   1st Qu.:-1.6282   1st Qu.:-0.5603  
##  Median :-0.13506   Median :-0.4777   Median : 0.1094   Median :-0.2084  
##  Mean   :-0.05374   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
##  3rd Qu.: 0.49235   3rd Qu.: 1.4054   3rd Qu.: 1.4188   3rd Qu.: 0.4083  
##  Max.   : 0.92238   Max.   : 3.3521   Max.   : 2.5897   Max.   : 3.1775  
##                                                                          
##  Song.Level.Entropy Theme.Level.Entropy Individuality       myVar      
##  Min.   :0.03744    Min.   :0.7253      Min.   :12.28   Min.   :11.08  
##  1st Qu.:0.14788    1st Qu.:0.9425      1st Qu.:25.96   1st Qu.:16.25  
##  Median :0.26520    Median :1.0102      Median :31.44   Median :18.78  
##  Mean   :0.27329    Mean   :1.1955      Mean   :34.30   Mean   :20.04  
##  3rd Qu.:0.34729    3rd Qu.:1.3715      3rd Qu.:39.14   3rd Qu.:23.50  
##  Max.   :0.61224    Max.   :1.8287      Max.   :60.52   Max.   :29.75  
##                                         NA&#39;s   :2</code></pre>
<pre class="r"><code># get stats (mean + sd) of mean.unique.units.per.cycle from Allen et al.
normPars &lt;- fitdistr(z$myVar,&quot;normal&quot;)
print(normPars) # mean is 20.038462 , sd is 1.014290</code></pre>
<pre><code>##      mean         sd    
##   20.038462    5.171887 
##  ( 1.434423) ( 1.014290)</code></pre>
<pre class="r"><code>str(normPars)</code></pre>
<pre><code>## List of 5
##  $ estimate: Named num [1:2] 20.04 5.17
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ sd      : Named num [1:2] 1.43 1.01
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ vcov    : num [1:2, 1:2] 2.06 0 0 1.03
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ n       : int 13
##  $ loglik  : num -39.8
##  - attr(*, &quot;class&quot;)= chr &quot;fitdistr&quot;</code></pre>
<pre class="r"><code>zMean &lt;- normPars$estimate[&quot;mean&quot;] # note structure of getting a named attribute -&gt; mean is 20.61364 (as stated above)
zSD &lt;- normPars$estimate[&quot;sd&quot;] 
# Using data from Allen et al., 2018 - mean unique units per cycle


# generate random normal data with the mean and sd from that dataset
counts &lt;- rnorm(n=3,mean=zMean,sd=zSD)
years &lt;- c(&quot;2002&quot;,&quot;2003&quot;,&quot;2004&quot;)

# make that normal data into a data frame
normz &lt;- data.frame(years,counts)
print(normz)</code></pre>
<pre><code>##   years   counts
## 1  2002 30.26881
## 2  2003 16.14408
## 3  2004 16.56853</code></pre>
<pre class="r"><code># setting up one-way ANOVA - just the first 3 years

nGroup &lt;-  3
nName &lt;- c(&quot;2002&quot;,&quot;2003&quot;,&quot;2004&quot;) # names of groups
nSize &lt;- c(1,1,1) # number of observations in each group

# get the mean + sd
# 2002
year &lt;- normz[normz$years==&quot;2002&quot;,]
print(year)</code></pre>
<pre><code>##   years   counts
## 1  2002 30.26881</code></pre>
<pre class="r"><code>summary2002 &lt;- summary(year[,&quot;counts&quot;])
print(summary2002)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   30.27   30.27   30.27   30.27   30.27   30.27</code></pre>
<pre class="r"><code>mean2002 &lt;- summary2002[&quot;Mean&quot;]
print(mean2002)</code></pre>
<pre><code>##     Mean 
## 30.26881</code></pre>
<pre class="r"><code>sd2002 &lt;- sd((year[,&quot;counts&quot;]))
print(sd2002)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code># 2003
year &lt;- normz[normz$years==&quot;2003&quot;,]
print(year)</code></pre>
<pre><code>##   years   counts
## 2  2003 16.14408</code></pre>
<pre class="r"><code>summary2003 &lt;- summary(year[,&quot;counts&quot;])
print(summary2003)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   16.14   16.14   16.14   16.14   16.14   16.14</code></pre>
<pre class="r"><code>mean2003 &lt;- summary2003[&quot;Mean&quot;]
print(mean2003)</code></pre>
<pre><code>##     Mean 
## 16.14408</code></pre>
<pre class="r"><code>sd2003 &lt;- sd((year[,&quot;counts&quot;]))
print(sd2003)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code># 2004
year &lt;- normz[normz$years==&quot;2004&quot;,]
print(year)</code></pre>
<pre><code>##   years   counts
## 3  2004 16.56853</code></pre>
<pre class="r"><code>summary2004 &lt;- summary(year[,&quot;counts&quot;])
print(summary2004)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   16.57   16.57   16.57   16.57   16.57   16.57</code></pre>
<pre class="r"><code>mean2004 &lt;- summary2004[&quot;Mean&quot;]
print(mean2004)</code></pre>
<pre><code>##     Mean 
## 16.56853</code></pre>
<pre class="r"><code>sd2004 &lt;- sd((year[,&quot;counts&quot;]))
print(sd2004)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code># I am gettng NA for SD because there&#39;s really only one value which IS the mean, so I&#39;m just going to assign random values

sd2002 &lt;- 3
sd2003 &lt;- 2
sd2004 &lt;- 1

# adjusting the means of different groups!

# mean2002 &lt;- 15.1
# mean2003 &lt;- 15.2
# mean2004 &lt;- 15.3

ID &lt;- 1:(sum(nSize)) # ID vector for each row (sum of the number of observations) - the overall number of rows we need!

resVar &lt;- c(rnorm(n=nSize[1],mean=mean2002,sd=sd2002),
            rnorm(n=nSize[2],mean=mean2003,sd=sd2003),
            rnorm(n=nSize[3],mean=mean2004,sd=sd2004))

# doing the ANOVA

TGroup &lt;- rep(nName,nSize) # repeating the name by the number
ANOdata &lt;- data.frame(ID,TGroup,resVar) #
str(ANOdata)</code></pre>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  3 variables:
##  $ ID    : int  1 2 3
##  $ TGroup: chr  &quot;2002&quot; &quot;2003&quot; &quot;2004&quot;
##  $ resVar: num  30.4 16 16</code></pre>
<pre class="r"><code>print(ANOdata)</code></pre>
<pre><code>##   ID TGroup   resVar
## 1  1   2002 30.38872
## 2  2   2003 16.01772
## 3  3   2004 15.96990</code></pre>
<pre class="r"><code># make graph

ANOPlot &lt;- ggplot(data=ANOdata,aes(x=TGroup,y=resVar,fill=TGroup)) +
  geom_boxplot()
print(ANOPlot)</code></pre>
<p><img src="Homework_07_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code># Adjust the means of different groups: if I raise the means of all groups to 25, the ANOVA looks more uniform but still follows the same trend. If I lower the means of all groups to 15, it still seems to follow the same trend for the first 2 groups, but the last group&#39;s (2004) resVar skyrockets (not sure why). If I make mean2002 5, mean2003 15, and mean2004 25, the resVars follow the same trend. If the means are within 0.1 of each other, there still appears to be some significant difference, but with means within 0.01 of each other there is none.

# Adjust the sample sizes of different groups: by adjusting the sample size down to 3 per group, I see more of a significant difference between the 3 groups. Even given a sample size one 1, I see significance.</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
